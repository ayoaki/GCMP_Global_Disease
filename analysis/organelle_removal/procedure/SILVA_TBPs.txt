#download SILVA files, generate taxonomy, generate TBP of M/T/S samples

#get OTUs
wget -O input/SILVA_OTUs.qza "https://www.dropbox.com/s/ce6cj4m24pi7doy/99-otus.qza?dl=0"

#get taxonomy
wget -O input/SILVA_taxonomy.qza "https://www.dropbox.com/s/5tv5uk95pk3ukwf/7_level_taxonomy.qza?dl=0"

#feature classifier with SILVA files
qiime feature-classifier classify-consensus-vsearch --i-query input/all.seqs.qza --i-reference-reads input/SILVA_OTUs.qza --i-reference-taxonomy input/SILVA_taxonomy.qza --p-strand plus --p-threads 4 --o-classification input/SILVA_classification_taxonomy.qza

#TBP visualizers
qiime taxa barplot --i-table M_ft.qza --i-taxonomy input/SILVA_classification_taxonomy.qza --m-metadata-file input/GCMP_EMP_map_r28.txt --o-visualization output/SILVA_M_tbp.qzv
qiime taxa barplot --i-table T_ft.qza --i-taxonomy input/SILVA_classification_taxonomy.qza --m-metadata-file input/GCMP_EMP_map_r28.txt --o-visualization output/SILVA_T_tbp.qzv
qiime taxa barplot --i-table S_ft.qza --i-taxonomy input/SILVA_classification_taxonomy.qza --m-metadata-file input/GCMP_EMP_map_r28.txt --o-visualization output/SILVA_S_tbp.qzv

#I assume there's a way to pull values directly from the data files, but I've gone to view.qiime2.org to view the TBPs, then downloaded the CSV files - level 1 for unassigned and level 5 for mitochondria
#once I had the CSV files, add a column with total abundance, and a relative abundance column that divides the column of interest by the total abundance.